<!DOCTYPE html>
<html lang="en-us">
<head>
<meta charset="utf-8">
<meta name="description" content="">
<meta name="generator" content="Hugo 0.95.0" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/css/style.css" type="text/css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700" type="text/css">
<link rel="alternate" href="/index.xml" type="application/rss+xml" title="kliiu">
<title>SQL必知必会 - kliiu</title>
</head>
<body>

<header>
  <div class="container clearfix">
    <a  class="path" href="http://kliiu.github.io/">[kliiu]</a>
    <span class="caret"></span>
    <div class="right">
      
    </div>
  </div>
</header>

<div class="container">


<main role="main" class="article">
  
<article class="single" itemscope itemtype="http://schema.org/BlogPosting">
  <div class="meta">

    <span class="key">published on</span>
    <span class="val"><time itemprop="datePublished" datetime="2022-03-25">March 25, 2022</time></span>


    <span class="key">in</span>
    <span class="val">

        <a href="/categories/coding">Coding</a>

    </span>


    <br>
    <span class="key">tags:</span>
    <span class="val">

        <a href="/tags/code">code</a>

        <a href="/tags/stl">STL</a>

    </span>

  </div>
  <h1 class="headline" itemprop="headline">SQL必知必会</h1>
  <section class="body" itemprop="articleBody">
    <h2 id="lesson-5-高级数据过滤">Lesson 5 高级数据过滤</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">--operator AND IN OR
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> prod_id,prod_price,prod_name
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> Products
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> vend_id <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;DLL01&#39;</span> <span style="color:#66d9ef">AND</span> prod_price <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">4</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> prod_id,prod_price,prod_name,vend_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> Products
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> vend_id <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;DLL01&#39;</span> <span style="color:#66d9ef">OR</span> vend_id <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;BRS01&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#75715e">--AND 比OR优先级高 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> prod_price,prod_name
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> Products
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> (vend_id <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;DLL01&#39;</span> <span style="color:#66d9ef">OR</span> vend_id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;BRS01&#39;</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">AND</span> prod_price <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">10</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">--IN 与or功能相同
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">--比OR快
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> prod_id,prod_price,prod_name,vend_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> Products
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> vend_id <span style="color:#66d9ef">IN</span> (<span style="color:#e6db74">&#39;DLL01&#39;</span>,<span style="color:#e6db74">&#39;BRS01&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">--NOT 否定条件,与其他条件一起使用
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> prod_name,vend_id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> Products
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> <span style="color:#66d9ef">NOT</span> vend_id <span style="color:#66d9ef">IN</span> (<span style="color:#e6db74">&#39;DLL01&#39;</span>,<span style="color:#e6db74">&#39;BRS01&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">--5.5.1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> vend_name,vend_state,vend_country
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> Vendors
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> vend_country<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;USA&#39;</span> <span style="color:#66d9ef">AND</span> vend_state<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;CA&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">--5.5.2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> order_num,prod_id,quantity
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> OrderItems
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> prod_id <span style="color:#66d9ef">IN</span> (<span style="color:#e6db74">&#39;BR01&#39;</span>,<span style="color:#e6db74">&#39;BR02&#39;</span>,<span style="color:#e6db74">&#39;BR03&#39;</span>) <span style="color:#66d9ef">AND</span> quantity<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">100</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">--5.5.3
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> prod_name,prod_price
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> Products
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> prod_price<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">3</span> <span style="color:#66d9ef">AND</span> prod_price<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">6</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> prod_price
</span></span><span style="display:flex;"><span><span style="color:#75715e">--
</span></span></span></code></pre></div><h2 id="lesson-6-用通配符进行过滤">Lesson 6 用通配符进行过滤</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#75715e">--通配符只能用于文本字段
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> prod_id,prod_name
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> Products
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> prod_name <span style="color:#66d9ef">LIKE</span> <span style="color:#e6db74">&#39;Fish%&#39;</span>;<span style="color:#75715e">--%表示任意字符出现任意次数，Fish开头的
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> prod_id,prod_name
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> Products
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> prod_name <span style="color:#66d9ef">LIKE</span> <span style="color:#e6db74">&#39;F%y&#39;</span>;<span style="color:#75715e">-- WHERE email LIKE &#39;b%@forta.com&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> prod_id,prod_name
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> Products
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> prod_name <span style="color:#66d9ef">LIKE</span> <span style="color:#e6db74">&#39;_ inch teddy bear&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#75715e">-- _ 下划线只匹配单个字符
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">--输出 8 inch teddy bear, 而不会返回 12 inch teddy bear
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> cust_contact
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> Customers
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> cust_contact <span style="color:#66d9ef">LIKE</span> <span style="color:#e6db74">&#39;[JM]%&#39;</span><span style="color:#75715e">--[]匹配方括号中任意一个字符，%匹配第一个字符后的任意数目字符。返回以J或M开头的
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> cust_contact;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> cust_contact
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> Customers
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> cust_contact <span style="color:#66d9ef">LIKE</span> <span style="color:#e6db74">&#39;[^JM]%&#39;</span><span style="color:#75715e">-- ^脱字号 否定
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> cust_contact;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> cust_contact
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> Customers
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> <span style="color:#66d9ef">NOT</span> cust_contact <span style="color:#66d9ef">LIKE</span> <span style="color:#e6db74">&#39;[JM]%&#39;</span><span style="color:#75715e">-- NOT 否定
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> cust_contact;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">--6.4.1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> prod_desc,prod_name
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> Products
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> prod_desc <span style="color:#66d9ef">LIKE</span> <span style="color:#e6db74">&#39;%toy%&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">--6.4.2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> prod_desc,prod_name
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> Products
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> <span style="color:#66d9ef">NOT</span> prod_desc <span style="color:#66d9ef">LIKE</span> <span style="color:#e6db74">&#39;%toy%&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">--6.4.3
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> prod_desc,prod_name
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> Products
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> (prod_desc <span style="color:#66d9ef">LIKE</span> <span style="color:#e6db74">&#39;%toy%&#39;</span> )
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">AND</span> (prod_desc <span style="color:#66d9ef">LIKE</span> <span style="color:#e6db74">&#39;%carrots%&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">--6.4.4
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> prod_desc,prod_name
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> Products
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> prod_desc <span style="color:#66d9ef">LIKE</span> <span style="color:#e6db74">&#39;%toy%carrots%&#39;</span> ;
</span></span></code></pre></div><h2 id="lesson-7-创建计算字段">Lesson 7 创建计算字段</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">--拼接 +
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> vend_name <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;(&#39;</span><span style="color:#f92672">+</span> vend_country <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;)&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> Vendors
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> vend_name;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">--去掉值右边的全部空格 ：RTRIM()函数
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">--去掉左边的空格LTRIM(),TRIM()去掉左右的空格
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> RTRIM(vend_name)<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;(&#39;</span><span style="color:#f92672">+</span>RTRIM(vend_country)<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;)&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> Vendors
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> vend_name;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">--别名 as
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> RTRIM(vend_name)<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;(&#39;</span><span style="color:#f92672">+</span>RTRIM(vend_country)<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;)&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">AS</span> vend_title
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> Vendors
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> vend_name;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">--执行算数计算
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> prod_id,quantity,item_price,
</span></span><span style="display:flex;"><span>quantity<span style="color:#f92672">*</span>item_price <span style="color:#66d9ef">AS</span> expand_price<span style="color:#75715e">--计算字段
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">FROM</span> OrderItems
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> order_num<span style="color:#f92672">=</span><span style="color:#ae81ff">20008</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">--7.5.1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span>  vend_id,vend_name <span style="color:#66d9ef">AS</span> vname,
</span></span><span style="display:flex;"><span>vend_address <span style="color:#66d9ef">AS</span> vaddress,
</span></span><span style="display:flex;"><span>vend_city <span style="color:#66d9ef">AS</span> vcity
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> Vendors
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> vend_name;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">--7.5.2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> prod_id,prod_price,
</span></span><span style="display:flex;"><span>prod_price<span style="color:#f92672">*</span><span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">9</span> <span style="color:#66d9ef">AS</span> sale_price<span style="color:#75715e">--计算字段
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">FROM</span> Products;
</span></span></code></pre></div>
  </section>
</article>

</main>

</div>

<footer>
  <div class="container">
    <span class="copyright">&copy; 2022 kliiu - <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></span>
  </div>
</footer>

</body>
</html>

